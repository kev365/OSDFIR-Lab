graph TD
    A[Start OSDFIR Lab Deployment] --> B{Prerequisites Check}
    B -->|Missing Tools| C[Install Docker Desktop<br/>Minikube, kubectl<br/>Terraform, Helm]
    B -->|All Present| D[Run Unified Management Script<br/>manage-osdfir-lab.ps1 deploy]
    C --> D
    
    D --> E[Auto-Start Docker Desktop<br/>Resource Detection & Allocation]
    E --> F[Start Minikube Cluster<br/>Optimal CPU/Memory Configuration]
    F --> G[Apply Terraform Infrastructure<br/>Namespace, PVC, Helm Release]
    G --> H[Deploy OSDFIR Tools<br/>Timesketch, OpenRelik, HashR, Yeti]
    H --> I[Deploy Ollama AI Service<br/>Local AI Model Server]
    
    I --> J{Model Download Status}
    J -->|In Progress| K["Wait for AI Model Download<br/>gemma2:2b (~1.6GB)"]
    K --> L[Model Downloaded<br/>Ollama Service Ready]
    J -->|Complete| L
    
    L --> M[Configure AI Integration<br/>Centralized YAML Configuration]
    M --> N[Start Port Forwarding<br/>Automatic Background Jobs]
    N --> O[OSDFIR Lab Ready]
    
    O --> P{Access Services}
    P --> Q[Timesketch UI<br/>http://localhost:5000]
    P --> R[OpenRelik UI<br/>http://localhost:8711]
    P --> S[OpenRelik API<br/>http://localhost:8710]
    P --> T[AI Model Testing<br/>manage-osdfir-lab.ps1 ollama]
    
    Q --> U[Digital Forensics Timeline Analysis]
    R --> V[Evidence Processing Pipeline]
    S --> W[API-Based Analysis]
    T --> X[AI-Assisted Evidence Analysis<br/>Using Gemma2:2b Model]
    
    U --> Y[Investigation Results]
    V --> Y
    W --> Y
    X --> Y
    
    Y --> Z{Continue Investigation}
    Z -->|Yes| AA[Process More Evidence]
    Z -->|No| BB[Export Results<br/>Generate Reports]
    
    AA --> V
    BB --> CC[Cleanup Environment<br/>manage-osdfir-lab.ps1 teardown-lab]
    
    subgraph "AI Integration Features"
        X1[Timesketch NL2Q<br/>Natural Language to Query]
        X2[Event Summarization<br/>AI-Powered Analysis]
        X3[OpenRelik AI Workers<br/>Evidence Processing]
        X4[Centralized AI Config<br/>Single YAML Management]
        X --> X1
        X --> X2
        X --> X3
        X --> X4
    end
    
    subgraph "Management Operations"
        O1[Check Status<br/>manage-osdfir-lab.ps1 status]
        O2[View Logs<br/>manage-osdfir-lab.ps1 logs]
        O3[Get Credentials<br/>manage-osdfir-lab.ps1 creds]
        O4[Monitor AI<br/>manage-osdfir-lab.ps1 ollama]
        O5[Start Services<br/>manage-osdfir-lab.ps1 start]
        O6[Stop Services<br/>manage-osdfir-lab.ps1 stop]
        O --> O1
        O --> O2
        O --> O3
        O --> O4
        O --> O5
        O --> O6
    end
    
    subgraph "Storage Management"
        S1[Shared PVC: osdfirvolume<br/>Evidence & Case Data Storage]
        S2[Ollama Model Cache<br/>AI Model Storage]
        S3[Terraform State<br/>Infrastructure State]
        G --> S1
        I --> S2
        G --> S3
    end 
